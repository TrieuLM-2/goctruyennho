<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ƒê·ªçc truy·ªán">
    <title>ƒê·ªçc truy·ªán - M√™ ƒë·ªçc truy·ªán ch·ªØ</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&family=Georgia&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/responsive.css">

    <link rel="icon" href="./assets/icons/favicon.ico">

    <style>
        .reading-content {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--space-8) var(--space-6);
        }

        .chapter-paragraph {
            margin-bottom: var(--space-6);
            text-align: justify;
        }

        .chapter-paragraph.lang-vn {
            font-weight: 500;
        }

        .chapter-paragraph.lang-en {
            color: var(--text-secondary);
            font-style: italic;
        }

        .chapter-nav {
            display: flex;
            justify-content: space-between;
            gap: var(--space-4);
            margin: var(--space-8) 0;
        }

        .settings-overlay {
            position: fixed;
            inset: 0;
            background-color: var(--bg-overlay);
            z-index: 89;
        }
    </style>
</head>

<body>
    <!-- Reading Progress Bar -->
    <div class="progress-bar">
        <div class="progress-fill" id="readingProgressBar"></div>
    </div>

    <!-- Header -->
    <header class="site-header">
        <div class="container flex items-center justify-between">
            <div class="flex items-center gap-4 flex-1">
                <button class="btn-icon" onclick="goToBookDetail()" title="Quay l·∫°i">
                    ‚¨ÖÔ∏è
                </button>
                <div class="flex-1">
                    <div class="text-sm text-secondary" id="bookTitle">Loading...</div>
                    <div class="font-semibold" id="chapterTitle">Loading...</div>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <div class="theme-toggle desktop-only">
                    <button class="theme-btn active" data-theme-btn="light" title="S√°ng">‚òÄÔ∏è</button>
                    <button class="theme-btn" data-theme-btn="dark" title="T·ªëi">üåô</button>
                    <button class="theme-btn" data-theme-btn="sepia" title="Sepia">üìÑ</button>
                </div>
                <button class="btn-icon" id="settingsToggle" title="C√†i ƒë·∫∑t">
                    ‚öôÔ∏è
                </button>
            </div>
        </div>
    </header>

    <!-- Settings Overlay -->
    <div class="settings-overlay hidden" id="settingsOverlay"></div>

    <!-- Floating Settings Panel -->
    <aside class="settings-panel" id="settingsPanel">
        <h3 class="sidebar-title mb-6">‚öôÔ∏è C√†i ƒë·∫∑t ƒë·ªçc</h3>

        <!-- Language Mode -->
        <div class="settings-group">
            <label class="settings-label">Ng√¥n ng·ªØ hi·ªÉn th·ªã</label>
            <div class="settings-options">
                <button class="settings-option" data-lang="vn">
                    üáªüá≥<br>Ti·∫øng Vi·ªát
                </button>
                <button class="settings-option" data-lang="en">
                    üá¨üáß<br>English
                </button>
                <button class="settings-option active" data-lang="bilingual">
                    üåê<br>Song ng·ªØ
                </button>
            </div>
        </div>

        <!-- Font Family -->
        <div class="settings-group">
            <label class="settings-label">Font ch·ªØ</label>
            <div class="settings-options">
                <button class="settings-option active" data-font="Nunito">Nunito</button>
                <button class="settings-option" data-font="Georgia">Georgia</button>
                <button class="settings-option" data-font="Arial">Arial</button>
            </div>
        </div>

        <!-- Font Size -->
        <div class="settings-group">
            <label class="settings-label">
                K√≠ch th∆∞·ªõc ch·ªØ: <span id="fontSizeValue">100%</span>
            </label>
            <input type="range" class="slider" id="fontSizeSlider" min="80" max="200" value="100">
        </div>

        <!-- Line Height -->
        <div class="settings-group">
            <label class="settings-label">
                Kho·∫£ng c√°ch d√≤ng: <span id="lineHeightValue">1.75</span>
            </label>
            <input type="range" class="slider" id="lineHeightSlider" min="1.0" max="2.5" step="0.25" value="1.75">
        </div>

        <!-- Text Alignment -->
        <div class="settings-group">
            <label class="settings-label">CƒÉn ch·ªânh</label>
            <div class="settings-options">
                <button class="settings-option active" data-align="left">
                    ‚¨ÖÔ∏è<br>Tr√°i
                </button>
                <button class="settings-option" data-align="center">
                    ‚ÜîÔ∏è<br>Gi·ªØa
                </button>
                <button class="settings-option" data-align="justify">
                    ‚¨å<br>ƒê·ªÅu
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main>
        <!-- Loading State -->
        <div id="loadingState" class="loading-overlay">
            <div class="spinner"></div>
        </div>

        <!-- Reader Content -->
        <div id="readerContent" class="hidden">
            <!-- Top Navigation -->
            <div class="container">
                <div class="chapter-nav">
                    <button class="btn btn-secondary" id="prevChapterBtn">
                        ‚Äπ Ch∆∞∆°ng tr∆∞·ªõc
                    </button>
                    <button class="btn btn-secondary" onclick="goToBookDetail()">
                        üìë M·ª•c l·ª•c
                    </button>
                    <button class="btn btn-secondary" id="nextChapterBtn">
                        Ch∆∞∆°ng sau ‚Ä∫
                    </button>
                </div>
            </div>

            <!-- Chapter Content -->
            <article class="reading-content" id="chapterContent">
                <!-- Content will be loaded here -->
            </article>

            <!-- Bottom Navigation -->
            <div class="container">
                <div class="chapter-nav">
                    <button class="btn btn-secondary" id="prevChapterBtnBottom">
                        ‚Äπ Ch∆∞∆°ng tr∆∞·ªõc
                    </button>
                    <button class="btn btn-secondary" onclick="goToBookDetail()">
                        üìë M·ª•c l·ª•c
                    </button>
                    <button class="btn btn-secondary" id="nextChapterBtnBottom">
                        Ch∆∞∆°ng sau ‚Ä∫
                    </button>
                </div>
            </div>

            <!-- Rating Section (only for final chapter) -->
            <section class="container mt-12 mb-8" id="ratingSection" style="display: none;">
                <div class="bg-secondary rounded-lg p-8 text-center">
                    <h3 class="text-2xl font-bold mb-4">‚≠ê ƒê√°nh gi√° truy·ªán n√†y</h3>
                    <p class="text-secondary mb-6">B·∫°n th·∫•y truy·ªán n√†y th·∫ø n√†o?</p>

                    <div id="ratingForm">
                        <div class="rating-stars justify-center mb-6" id="ratingStars">
                            <span class="star" data-rating="1" onclick="setRating(1)">‚òÜ</span>
                            <span class="star" data-rating="2" onclick="setRating(2)">‚òÜ</span>
                            <span class="star" data-rating="3" onclick="setRating(3)">‚òÜ</span>
                            <span class="star" data-rating="4" onclick="setRating(4)">‚òÜ</span>
                            <span class="star" data-rating="5" onclick="setRating(5)">‚òÜ</span>
                        </div>
                        <button class="btn btn-primary" onclick="submitRating()">
                            G·ª≠i ƒë√°nh gi√°
                        </button>
                    </div>

                    <div id="ratingThanks" style="display: none;">
                        <p class="text-lg">üéâ C·∫£m ∆°n b·∫°n ƒë√£ ƒë√°nh gi√°!</p>
                    </div>
                </div>
            </section>

            <!-- Comments Section -->
            <section class="container mb-12">
                <h3 class="text-2xl font-bold mb-6">üí¨ B√¨nh lu·∫≠n ch∆∞∆°ng n√†y</h3>

                <!-- Comment Form -->
                <div class="mb-6">
                    <textarea class="form-textarea" id="commentInput" placeholder="Vi·∫øt b√¨nh lu·∫≠n c·ªßa b·∫°n..."
                        rows="4"></textarea>
                    <button class="btn btn-primary mt-3" onclick="submitComment()">
                        G·ª≠i b√¨nh lu·∫≠n
                    </button>
                </div>

                <!-- Comments List -->
                <div id="chapterComments">
                    <!-- Comments will be loaded here -->
                </div>
            </section>
        </div>
    </main>

    <!-- Scripts -->
    <script src="./js/utils.js"></script>
    <script src="./js/theme.js"></script>
    <script src="./js/data-manager.js"></script>
    <script src="./js/reader.js"></script>
    <script>
        // Rating interaction
        function setRating(rating) {
            const stars = document.querySelectorAll('#ratingStars .star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.textContent = '‚òÖ';
                    star.classList.add('filled');
                } else {
                    star.textContent = '‚òÜ';
                    star.classList.remove('filled');
                }
            });
        }

        // Sync bottom navigation with top navigation
        document.addEventListener('DOMContentLoaded', () => {
            const topPrev = document.getElementById('prevChapterBtn');
            const topNext = document.getElementById('nextChapterBtn');
            const bottomPrev = document.getElementById('prevChapterBtnBottom');
            const bottomNext = document.getElementById('nextChapterBtnBottom');

            if (topPrev && bottomPrev) {
                bottomPrev.disabled = topPrev.disabled;
                bottomPrev.onclick = topPrev.onclick;
            }

            if (topNext && bottomNext) {
                bottomNext.disabled = topNext.disabled;
                bottomNext.onclick = topNext.onclick;
            }
        });
    </script>
</body>

</html>